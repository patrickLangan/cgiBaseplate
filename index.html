<!doctype html>
<html lang="en-US">
<head>
	<meta charset="utf-8">
	<title>File upload</title>
	<meta name="description" content="Testing fastCGI file uploading">
	<meta name="robots" content="index, follow">
</head>
<body>

<form>
	<input name="file" type="file" id="file"/>
	<button type="button" id="button">UPLOAD</button>
</form>

<div>
	<div id="progress" style="width: 400px; border: 1px solid black">
		<div id="progressbar" style="width: 1px; background-color: black; border: 1px solid black"></div>
	</div>
</div>

<script type="text/javascript" language="javascript"></script>
<script>
	document.getElementById ('button').onclick = function () {
		var file = document.getElementById ('file').files.item (0);

		var postReq = new XMLHttpRequest ();
		var postBody = new FormData ();  

		postBody.append ('file', file); 

		postReq.upload.onprogress = function (evnt) {
			if (evnt.lengthComputable) {
				var percent = (evnt.loaded / evnt.total) * 400;  
				document.getElementById ("progressbar").style.width = percent + 'px';
			}
		}

		postReq.onreadystatechange = function () {
			if (postReq.readyState == 4) {
				if (postReq.status == 200) {
					document.getElementById ("progressbar").style.width = '400px';
				}
			}
		}

		postReq.open ("POST", "/upload");
		postReq.send (postBody);
	}

</script>

</body>
</html>

